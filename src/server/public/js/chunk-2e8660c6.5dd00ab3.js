(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e8660c6"],{"0607":function(t,e,r){"use strict";r.d(e,"c",(function(){return n})),r.d(e,"a",(function(){return a})),r.d(e,"d",(function(){return o})),r.d(e,"b",(function(){return s}));var i=r("6022");function n(){return i["a"].get({url:"/api/barrages"})}function a(t){return i["a"].post({url:"/api/barrage",data:t})}function o(t,e){return i["a"].put({url:"/api/barrage/"+t,data:e})}function s(t){return i["a"].delete({url:"/api/barrage/"+t})}},"2e9b":function(t,e,r){"use strict";r("7fbc")},"7fbc":function(t,e,r){},"991c":function(t,e,r){!function(e,r){t.exports=r()}("undefined"!=typeof self&&self,(function(){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=5)}([function(t,e,r){"use strict";var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();e.a=i},function(t,e,r){"use strict";var i=function(){return window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.clearTimeout}();e.a=i},function(t,e,r){"use strict";function i(t,e){return Object(n.a)(t)?window.getComputedStyle(t,null).getPropertyValue(e):"string"==typeof t&&document.querySelector(t)?window.getComputedStyle(document.querySelector(t),null).getPropertyValue(e):void 0}e.a=i;var n=r(7)},function(t,e,r){"use strict";function i(t){var e=document.createElement("style"),r=document.head||document.getElementsByTagName("head")[0];if(e.type="text/css",e.styleSheet){var i=function(){try{e.styleSheet.cssText=t}catch(t){console.error(t)}};e.styleSheet.disabled?setTimeout(i,10):i()}else{var n=document.createTextNode(t);e.appendChild(n)}r.appendChild(e)}e.a=i},function(t,e,r){"use strict";var i=function(){function t(t){t.target,t.data,t.speed,this.options={target:"",data:[],speed:5},this.extendOpt(arguments[0]),this.targetElement=document.querySelector(this.options.target)}return t.prototype.extendOpt=function(t){var e=this;for(var r in t)t.hasOwnProperty(r)&&(e.options[r]=t[r])},t.prototype.createElement=function(t){void 0===t&&(t="");var e=[];this.scroxtWrapper||(this.scroxtWrapper=document.createElement("div"),this.scroxtWrapper.className="scroxt-wrapper",this.targetElement=document.querySelector(this.options.target),this.targetElement.appendChild(this.scroxtWrapper));for(var r=0,i=this.options.data.length;r<i;r++){var n=document.createElement("div");n.className=t;var a=this.options.data[r];n.innerHTML=a,this.scroxtWrapper.appendChild(n),e.push(n)}return e},t.prototype.emptyElement=function(){this.scroxtWrapper&&(this.scroxtWrapper.innerHTML="")},t}();e.a=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(6),n=r(8),a=r(9),o=r(11),s={};Object.defineProperty(s,"Horizontal",{value:i.a,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(s,"Vertical",{value:n.a,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(s,"Barrage",{value:a.a,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(s,"Live",{value:o.a,writable:!1,enumerable:!1,configurable:!1}),window.scroxt=s,e.default=s},function(t,e,r){"use strict";var i=r(4),n=r(0),a=r(1),o=r(2),s=r(3),c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),p=function(t){function e(e){var r=e.target,i=e.data,n=e.speed,a=e.gap,o=void 0===a?10:a,s=t.call(this,{target:r,data:i,speed:n})||this;return s.sumWidth=0,s.distance=0,s.targetWidth=0,s.divWrapElementWidth=0,s.targetElementBorderWidth=0,s.ST=0,s.scroxtGap=o,s.createStyle(),s.init(),s}return c(e,t),e.prototype.createStyle=function(){Object(s.a)('\n            .scroxt-wrapper::after{\n                display: block;\n                content: "";\n                clear: both;\n            }\n            .scroxt-horizontal{\n                float: left;\n                margin-right: '+this.scroxtGap+"px;\n                white-space: nowrap;\n                box-sizing: border-box;\n            }\n        ")},e.prototype.init=function(){if(this.targetWidth=parseFloat(Object(o.a)(this.targetElement,"width")),this.targetElementBorderWidth=parseFloat(Object(o.a)(this.targetElement,"border-width")),this.createHorizontal(),this.divWrapElementWidth/2<this.targetWidth){this.emptyElement();var t=this.createElement("scroxt-horizontal");return this.divWrapElementWidth=this.computeWidth(t)+t.length*this.scroxtGap,this.scroxtWrapper.style.width=this.divWrapElementWidth+"px",void(this.scroxtWrapper.style.marginLeft="0px")}this.STRun()},e.prototype.createHorizontal=function(){this.emptyElement();var t=this.createElement("scroxt-horizontal"),e=this.createElement("scroxt-horizontal"),r=t.concat(e);this.divWrapElementWidth=this.computeWidth(r)+r.length*this.scroxtGap,this.scroxtWrapper.style.width=this.divWrapElementWidth+"px"},e.prototype.computeWidth=function(t){for(var e=0,r=0,i=t.length;r<i;r++)e+=Math.ceil(+Object(o.a)(t[r],"width").replace("px",""));return e},e.prototype.STRun=function(){this.divWrapElementWidth/2<this.targetWidth||(this.STMove(),this.ST=Object(n.a)(function(){this.STRun()}.bind(this)))},e.prototype.STMove=function(){var t=this.scroxtWrapper.getBoundingClientRect(),e=t.left+(t.right-t.left)/2,r=this.targetElement.getBoundingClientRect();if(this.options.speed<0){var i=r.left+this.targetElementBorderWidth;e+.1*this.options.speed<=i&&(this.distance=0,this.createHorizontal(),this.scroxtWrapper.style.left="0px",this.scroxtWrapper.style.marginLeft="0px")}else{var n=r.right-2*this.targetElementBorderWidth;e+.1*this.options.speed>=n&&(this.distance=-this.divWrapElementWidth+this.targetWidth,this.createHorizontal(),this.scroxtWrapper.style.right="0px",this.scroxtWrapper.style.marginRight="0px")}this.scroxtWrapper.style.transform="translate3d("+this.distance+"px, 0px, 0px)",this.scroxtWrapper.style.webkitTransform="translate3d("+this.distance+"px, 0px, 0px)",this.distance+=.1*this.options.speed},e.prototype.stopMove=function(){Object(a.a)(this.ST),this.ST=0},e.prototype.startMove=function(){0===this.ST&&this.STRun()},e}(i.a);e.a=p},function(t,e,r){"use strict";function i(t){return!(!t||!t.nodeType)&&1===t.nodeType}e.a=i},function(t,e,r){"use strict";var i=r(4),n=r(0),a=r(1),o=r(2),s=r(3),c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),p=function(t){function e(e){var r=t.call(this,e)||this;return r.targetHeight=0,r.divWrapElementHeight=0,r.distance=0,r.ST=0,r.targetHeight=parseFloat(Object(o.a)(r.targetElement,"height")),r.createStyle(),r.startRun(),r}return c(e,t),e.prototype.startRun=function(){if(this.divWrapElementHeight=this.createVertical(),this.targetHeight>this.divWrapElementHeight/2)return this.emptyElement(),void this.createElement("scroxt-vertical");this.STRun()},e.prototype.createStyle=function(){Object(s.a)("\n            .scroxt-vertical{\n                box-sizing: border-box;\n            }\n        ")},e.prototype.createVertical=function(){this.emptyElement();var t=this.createElement("scroxt-vertical"),e=this.createElement("scroxt-vertical");return this.computeHeight(t.concat(e))},e.prototype.computeHeight=function(t){for(var e=0,r=0,i=t.length;r<i;r++)e+=Math.ceil(+Object(o.a)(t[r],"height").replace("px",""));return e},e.prototype.STRun=function(){this.targetHeight>this.divWrapElementHeight/2||(this.STMove(),this.ST=Object(n.a)(function(){this.STRun()}.bind(this)))},e.prototype.STMove=function(){this.options.speed<0?this.distance<=-this.divWrapElementHeight/2&&(this.createVertical(),this.distance=0):this.distance>=this.targetHeight-this.divWrapElementHeight/2&&(this.createVertical(),this.distance=this.targetHeight-this.divWrapElementHeight),this.scroxtWrapper.style.transform="translate3d(0px, "+this.distance+"px, 0px)",this.scroxtWrapper.style.webkitTransform="translate3d(0px, "+this.distance+"px, 0px)",this.distance+=.1*this.options.speed},e.prototype.stopMove=function(){Object(a.a)(this.ST),this.ST=0},e.prototype.startMove=function(){0===this.ST&&this.STRun()},e}(i.a);e.a=p},function(t,e,r){"use strict";var i=r(0),n=r(1),a=r(2),o=r(10),s=r(3),c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),p=function(t){function e(e){var r=e.video,i=e.dataTime,n=t.call(this)||this;return n.videoEnd=!1,n.barrageWrap=[],n.readyShowBarrage=[],n.staticBarrageST=null,n.runST=0,n.video=r,n.scroxtVideo=document.querySelector(n.video),n.dataTime=n.quickSort(i),console.log(n.dataTime),n.tempDataTime=JSON.parse(JSON.stringify(n.dataTime)),n.lineHeight=28,n.videoWidth=parseInt(Object(a.a)(n.video,"width")),n.MAX_LINE=~~(parseInt(Object(a.a)(n.video,"height"))/n.lineHeight),n.MAX_NUM=50,n.distance=-5,n.colorFont=["#ffff38","#c80115","#189add"],n.createStyle(),n.startRun(),n}return c(e,t),e.prototype.quickSort=function(t){if(t.length<=1)return t;for(var e=t.splice(Math.floor(t.length/2),1)[0],r=[],i=[],n=0,a=t.length;n<a;n++)t[n].time<e.time?r.push(t[n]):i.push(t[n]);return this.quickSort(r).concat(e,this.quickSort(i))},e.prototype.createStyle=function(){Object(s.a)('\n            .multi-barrage-line{\n              position: absolute;\n              display: inline-block;\n              top: 0;\n              user-select:none;\n              white-space: pre;\n              color: #fff;\n              font-size: 25px;\n              font-family:SimHei, "Microsoft JhengHei", Arial, Helvetica, sans-serif;\n              font-weight:bold;\n              line-height: 1.125;\n              text-shadow:rgb(0, 0, 0) 1px 0px 1px, rgb(0, 0, 0) 0px 1px 1px, rgb(0, 0, 0) 0px -1px 1px, rgb(0, 0, 0) -1px 0px 1px;\n              transition:-webkit-transform 0s linear;\n              z-index: 1;\n              pointer-events: none;\n            }\n            .static-barrage-line{\n              position: absolute;\n              left: 50%;\n              transform:translateX(-50%);\n              -webkit-transform:translateX(-50%);\n              top: 0;\n              z-index: 2;\n            }\n        ')},e.prototype.startRun=function(){var t=this.scroxtVideo.className;this.scroxtVideo.className=t.indexOf("scroxt-video")>-1?t:t+" scroxt-video",this.timeUpdate()},e.prototype.play=function(){this.scroxtVideo.paused&&(this.scroxtVideo.play(),this.intervalRun())},e.prototype.stop=function(){this.scroxtVideo.paused||(this.scroxtVideo.pause(),this.intervalStop())},e.prototype.restart=function(){this.readyShowBarrage=[],this.tempDataTime=JSON.parse(JSON.stringify(this.dataTime)),this.scroxtVideo.currentTime=0,this.barrageWrap.forEach((function(t,e){var r=t.element.parentNode;r&&r.removeChild(t.element)})),this.barrageWrap=[]},e.prototype.moveInterval=function(t){void 0===t&&(t=0),this.readyShowBarrage=[],this.tempDataTime=JSON.parse(JSON.stringify(this.dataTime)),this.scroxtVideo.currentTime+=t,this.barrageWrap.forEach((function(t,e){var r=t.element.parentNode;r&&r.removeChild(t.element)})),this.barrageWrap=[]},e.prototype.timeUpdate=function(){this.scroxtVideo.addEventListener("timeupdate",function(){this.distribution(this.scroxtVideo.currentTime)}.bind(this))},e.prototype.distribution=function(t){for(var e=this.tempDataTime.length;0!==e&&this.tempDataTime[0].time<t;)this.tempDataTime[0].time>=t-2&&this.readyShowBarrage.push(this.tempDataTime[0].data),this.tempDataTime.shift(),e=this.tempDataTime.length},e.prototype.createBarrage=function(){var t=this.readyShowBarrage.length;if(t&&!(this.barrageWrap.length>this.MAX_NUM))for(var e=0;e<t;e++){if(e>this.MAX_LINE){t>20&&!this.staticBarrageST&&this.createStaticBarrage(this.readyShowBarrage.splice(0,this.MAX_LINE));break}var r=e%this.MAX_LINE,i=document.querySelectorAll("[data-line='"+r+"']"),n=i.length,a=void 0;if(n>0){a=i[n-1];var o=+a.getAttribute("data-width"),s=+a.getAttribute("data-move");if(Math.abs(s)+o>this.videoWidth)continue}var c=this.readyShowBarrage.shift(),p=Math.floor(1e3*Math.random())+ +new Date+e,h=e%2==0?10:0,l=document.createElement("div");l.className="multi-barrage-line";var u=document.createTextNode(""+c);l.appendChild(u),this.scroxtVideo.parentNode.appendChild(l);var d=parseInt(window.getComputedStyle(l,null).getPropertyValue("width")),f=d/600>=.5?.5:d/600,m="#fff";.5===f&&(m=this.colorFont[~~(Math.random()*this.colorFont.length)]),this.barrageWrap.push({element:l,scroxt:p,line:r,move:this.videoWidth+h+10,width:d,distance:f,color:m})}},e.prototype.createStaticBarrage=function(t){for(var e=this,r=0,i=t.length;r<i;r++)!function(r,i){var n=r%e.MAX_LINE,a=document.createElement("div");a.className="multi-barrage-line static-barrage-line",a.style.top=n*e.lineHeight+"px",a.style.color=e.colorFont[~~(Math.random()*e.colorFont.length)];var o=document.createTextNode(""+t[r]);a.appendChild(o),e.staticBarrageST=setTimeout(function(){this.staticBarrageST=null,this.scroxtVideo.parentNode.removeChild(a)}.bind(e),3e3),e.scroxtVideo.parentNode.appendChild(a)}(r)},e.prototype.moveLine=function(){for(var t=0;t<this.barrageWrap.length;t++){var e=this.barrageWrap[t],r=e.element,i=(e.scroxt,e.line),n=e.move,a=e.width,o=e.distance,s=e.color;if(n<=-a){this.barrageWrap.splice(t,1),t--;var c=r.parentNode;c&&c.removeChild(r)}else{var p=n+this.distance*o+this.distance/10;this.barrageWrap[t].move=p,r.style.cssText="color:"+s+";transform:translate3d("+p+"px,"+i*this.lineHeight+"px,0);"}}},e.prototype.intervalRun=function(){this.runST=Object(i.a)(function(){this.createBarrage(),this.moveLine(),this.intervalRun()}.bind(this))},e.prototype.intervalStop=function(){Object(n.a)(this.runST)},e}(o.a);e.a=p},function(t,e,r){"use strict";var i=function(){function t(){this.events={}}return t.prototype.on=function(t,e){this.events[t]?this.events[t].push(e):this.events[t]=[e]},t.prototype.off=function(t,e){this.events[t].splice(this.events[t].indexOf(e),1)},t.prototype.empty=function(t){this.events[t]=[]},t.prototype.triggle=function(t){this.events[t].forEach((function(t){t()}))},t}();e.a=i},function(t,e,r){"use strict";var i=r(2),n=r(3),a=r(0),o=r(1),s=function(){function t(t){var e=t.target,r=t.strongLock,n=void 0!==r&&r;this.barrage=[],this.selfBarrage=[],this.barrageWrap={},this.MAX_LINE=4,this.lineHeight=28,this.sumLine=0,this.lineGap=10,this.runST=0,this.targetElement=document.querySelector(e),this.strongLock=n,this.TARGET_WIDTH=parseInt(Object(i.a)(this.targetElement,"width")),this.MAX_LINE=~~(parseInt(Object(i.a)(this.targetElement,"height"))/this.lineHeight),this.gear=-5,this.LINE_LIMIT=300,this.startRun()}return t.prototype.startRun=function(){this.createStyle(),this.intervalRun()},t.prototype.createStyle=function(){Object(n.a)('\n            .multi-barrage-line{\n              position: absolute;\n              display: inline-block;\n              top: 0;\n              user-select:none;\n              white-space: pre;\n              color: #fff;\n              font-size: 25px;\n              font-family:SimHei, "Microsoft JhengHei", Arial, Helvetica, sans-serif;\n              font-weight:bold;\n              line-height: 1.125;\n              text-shadow:rgb(0, 0, 0) 1px 0px 1px, rgb(0, 0, 0) 0px 1px 1px, rgb(0, 0, 0) 0px -1px 1px, rgb(0, 0, 0) -1px 0px 1px;\n              transition:-webkit-transform 0s linear;\n              z-index: 1;\n              pointer-events: none;\n            }\n        ')},t.prototype.addBarrage=function(t,e){void 0===e&&(e=!1),e?this.selfBarrage.push(t):this.barrage.push(t)},t.prototype.createBarrage=function(){for(var t=0,e=this.barrage.length;e>0&&t<this.MAX_LINE;t++){var r=void 0,i=t%this.MAX_LINE;if(this.selfBarrage.length>0)r=this.selfBarrage.shift();else{if(this.strongLock&&this.sumLine>65){this.barrage=[];break}if(this.barrageWrap[i]){var n=this.barrageWrap[i].length;if(n>0){var a=this.barrageWrap[i][n-1];if(a.move+a.width>this.TARGET_WIDTH-this.lineGap)continue}}r=this.barrage.shift(),e--}this.generateBarrage(i,r)}},t.prototype.generateBarrage=function(t,e){var r=document.createElement("div");r.className="multi-barrage-line";var n=document.createTextNode(e);r.appendChild(n),r.style.opacity="0",this.targetElement.appendChild(r);var a=parseInt(Object(i.a)(r,"width")),o=a/600>=.5?.5:a/600;this.barrageWrap[t]?this.barrageWrap[t].push({element:r,line:t,move:this.TARGET_WIDTH,width:a,speed:o}):this.barrageWrap[t]=[{element:r,line:t,move:this.TARGET_WIDTH,width:a,speed:o}]},t.prototype.moveLine=function(){for(var t in this.sumLine=0,this.barrageWrap){var e=this.barrageWrap[t];this.sumLine+=e.length;for(var r=0;r<e.length;r++){var i=e[r],n=i.element,a=i.line,o=i.move,s=i.width,c=i.speed;if(o<=-s)e.splice(r,1),r--,this.targetElement.removeChild(n);else{var p=o+this.gear*c+this.gear/10;i.move=p,n.style.cssText="transform:translate3d("+p+"px,"+a*this.lineHeight+'px,0);opacity="1";'}}}},t.prototype.intervalRun=function(){this.runST=Object(a.a)(function(){this.moveLine(),this.createBarrage(),this.intervalRun()}.bind(this))},t.prototype.intervalStop=function(){Object(o.a)(this.runST)},t}();e.a=s}])}))},a917:function(t,e,r){"use strict";r.r(e);var i=r("7a23");const n=t=>(Object(i["H"])("data-v-7a4c0d46"),t=t(),Object(i["F"])(),t),a=n(()=>Object(i["m"])("div",{id:"barrage-container"},null,-1)),o=[a],s={class:"leave-name"},c=n(()=>Object(i["m"])("h2",null,"麻衣学姐是我的，大家没意见吧！",-1));function p(t,e,r,n,a,p){return Object(i["E"])(),Object(i["l"])(i["b"],null,[Object(i["m"])("header",{style:Object(i["x"])({"background-image":`url(${t.cover})`})},o,4),Object(i["m"])("main",null,[Object(i["m"])("div",s,[c,Object(i["Z"])(Object(i["m"])("textarea",{"onUpdate:modelValue":e[0]||(e[0]=e=>t.textinput=e)},null,512),[[i["U"],t.textinput]]),Object(i["m"])("button",{onClick:e[1]||(e[1]=(...e)=>t.sendBarrage&&t.sendBarrage(...e))},"🥳发条弹幕吧！")])])],64)}var h=r("0613"),l=r("991c"),u=r.n(l),d=r("0607"),f=r("fad3"),m=Object(i["p"])({mixins:[f["a"]],setup:function(){var t,e=[],r=Object(i["h"])((function(){return"/"+h["a"].state.cover})),n=Object(i["K"])(""),a=function(){t&&(t.addBarrage(n.value,!0),Object(d["a"])({content:n.value}),n.value="")};return Object(i["C"])((function(){Object(d["c"])().then((function(t){e=t.data.data})),t=new u.a.Live({target:"#barrage-container",strongLock:!0});for(var r=0;r<15;r++)setTimeout((function(){return t.addBarrage("一大波弹幕来袭！！！！")}),100*r);setTimeout((function(){setInterval((function(){var r,i;t.addBarrage(null!==(r=null===(i=e.shift())||void 0===i?void 0:i.content)&&void 0!==r?r:"")}),1e3)}),5e3)})),{cover:r,textinput:n,sendBarrage:a}}}),g=(r("2e9b"),r("6b0d")),v=r.n(g);const b=v()(m,[["render",p],["__scopeId","data-v-7a4c0d46"]]);e["default"]=b},fad3:function(t,e,r){"use strict";var i=r("6e55");e["a"]={mounted:function(){Object(i["a"])().reveal("header",{distance:"100px",duration:1e3,easing:"ease-out",interval:100,opacity:0,origin:"top"})}}}}]);
//# sourceMappingURL=chunk-2e8660c6.5dd00ab3.js.map